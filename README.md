# 东华大学-2025-数据结构课程设计

## 模拟上海铁路网络

---

## 目录

- [项目简介](#项目简介)
- [任务概述](#任务概述)
- [功能特性](#功能特性)
- [主要功能模块](#主要功能模块)
- [CSV 数据文件说明](#csv-数据文件说明)
- [项目目录结构参考](#项目目录结构参考)

---

## 项目简介

本项目旨在模拟真实的上海地铁网络，综合运用图结构、最短路径、优先队列、搜索优化等数据结构与算法，提供一个用户友好的地铁路径规划系统，实现多种路径查询功能，并支持地铁站点开放/关闭状态的动态管理。

---

## 任务概述

随着城市地铁交通的迅猛发展，乘客对通勤路径提出了更高要求：既希望尽量减少换乘，又希望总用时最短。本项目通过模拟上海地铁网络，满足用户多样化的路径规划需求。

---

## 功能特性

- **多种路径规划算法**
  - 最短时间路径（最少耗时）
  - 最少换乘路径
  - 多条候选路径输出（如时间最短的前3条路径）
- **地铁数据的加载与建图**
  - 从 CSV 文件加载地铁站点与线路信息
  - 构建邻接表图结构
- **动态修改**
  - 可通过 CSV 批量修改站点开放状态（开放/关闭）
  - 可手工修改站点开放状态（开放/关闭）
  - 可恢复站点初始状态（全开放）
  - 显示当前关闭的站点名单
- **系统交互**
  - 控制台二级菜单交互
  - 路径可视化输出（指定线路的站点信息、换乘信息）
  - 路径规划信息包括路径总时间、换乘站点、换乘次数、实际经过站点数
- **进阶功能（可选加分）**
  - 用户起点/终点模糊搜索（如部分输入“莘”匹配“莘庄”）
  - 可视化地铁网络图（图形界面）

---

## 主要功能模块

1. **数据加载与建模模块**
   - 读取 `Station.csv` 和 `Edge.csv`
   - 构建 stations 映射与 adj 邻接表
2. **最优路径规划模块**
   - `shortestPath`：规划单条最短时间路径（时间相同时，按换乘次数升序）
   - `kShortestTimePath`：规划前3条最短时间路径（时间相同时，按换乘次数升序）
   - `minTransferPath`：规划单条换乘次数最少路径（换乘次数相同时，按时间升序）
   - `kShortestTimePaths`：规划前3条换乘次数最少路径（换乘次数相同时，按时间升序）
   - 剪枝策略：避免回路、重复换乘、禁止经过关闭站点等
3. **路径输出与去重模块**
   - 显示路径站点、时间、换乘次数、实际经过站数（不含换乘）
   - 判断路径重复：通过线路序列或站点序列去重
4. **线路站点信息/运营状态管理模块**
   - `updateStationCsvStatus`：基于站点关闭列表数据文件（`update_station_status.csv`）批量更新站点数据文件 `Station.csv`
   - `resetStationStatus`：基于站点初始化数据文件 `Station_init.csv` 恢复 `Station.csv` 的初始状态
   - `showClosedStations`：显示当前关闭站点名单
   - `showInfobyLine`：显示指定地铁线路相关站点信息
5. **交互模块**
   - 二级菜单实现交互，可选择路径查询、站点状态修改、站点状态查看、恢复初始状态等功能，适用于多轮交互式测试与验证

---

## CSV 数据文件说明

1. **Station.csv（含站点开放/关闭状态）**
   - 记录所有地铁站点信息，包括站点ID、名称、所属线路及开放状态（开放/关闭）。
   - 系统运行过程中，路径搜索功能可根据该文件中的状态字段判断站点是否可通行，支持动态修改以模拟线路维护或突发事件（站点开放状态默认为“开启”）。
   - 需包含上海地铁1号线至18号线、浦江线、市域机场线的所有站点信息。
   - 包括站名相同的换乘站在内，共计524个站点。
   - 数据来源：上海地铁官方网站（https://service.shmetro.com/xlcz/index.htm）。
2. **update_station_status.csv（批量更新新站点状态）**
   - 读取该文件后能够自动更新 `Station.csv` 中对应站点的状态，实现快速状态管理。
3. **Edge.csv（地铁线路数据）**
   - 描述地铁站点之间的连接关系和通行耗时。其每一行代表一条边（即一段地铁线路）。
   - 包含以下字段：
     - 起点站 ID：邻接开始站点的 ID（与 `Station.csv` 中的 ID 一致）
     - 终点站 ID：邻接结束站点的 ID
     - 线路名称：该边所对应的地铁线路名称（如“1号线”、“2号线”、“换乘”等），也可用于判断是否换乘
     - 运行方向：内外圈信息（仅针对4号线，“内圈”、“外圈”）
     - 通行时间：相邻站点行驶时间
   - 本文件用于构建邻接表图结构，是路径规划算法的基础数据来源。
   - 包括换乘边在内，总共 1284 条边。注意：由于 A、B 相邻站点实际运行时，A→B 与 B→A 的行驶时间有可能不相同，最好按有向边处理，设置为 2 条边。
   - 换乘时间统一按 5 分钟计算。
   - 相邻站点间行驶所需时间参考上海地铁官网。

---

## 项目目录结构参考

```text
/project-root/
├── main.cpp                    // 主程序入口
├── station.h / .cpp            // 从 Station.csv 文件中读取数据，实现站点信息的加载与管理
├── graph.h / .cpp              // 从 Edge.csv 文件中读取数据，构建图的邻接表结构
├── menu.h / .cpp               // 二级菜单交互
├── pathfinder.h / .cpp         // 实现时间最短路径、最少换乘路径等算法
└── data/
    ├── Station.csv             // 存放相关数据文件
    ├── Edge.csv
    ├── update_station_status.csv
    ├── Station_init.csv
```

---

> 以上内容仅为参考
